Turbo Assembler	 Version 4.1	    12/07/19 01:50:39	    Page 1
myemu.ASM



      1	0000			     .MODEL SMALL
      2
      3	0000			     .STACK
      4
      5	0000			     .DATA
      6	0000  63 3A 5C 74 65 73	74+	 CD db "c:\test1\",0
      7	      31 5C 00
      8	000A  63 3A 5C 74 65 73	74+	 dir db	"c:\test1\test2",0
      9	      31 5C 74 65 73 74	32+
     10	      00
     11	0019  40*(24)			 buf db	64 DUP ('$')
     12	0059  45 52 52 4F 52 20	43+	 errchdir db "ERROR CHDIR $"
     13	      48 44 49 52 20 24
     14	0066  45 52 52 4F 52 20	4D+	 errmkdir db "ERROR MKDIR $"
     15	      4B 44 49 52 20 24
     16	0073  ????			 temp dw ?
     17
     18	0075			     .CODE
     19	0000			     start:
     20	0000  B8 0000s			 mov ax,@data
     21	0003  8E D8			 mov ds,ax
     22
     23	0005  E8 0062			 call show_drive
     24	0008  E8 0074			 call show_cwd
     25
     26	000B  BA 0000r			 mov dx,offset CD	     ; DS:DX ->	ASCIZ pathname to become current directory (max	64  +
     27				     bytes)
     28	000E  B4 3B			 mov ah,3Bh		     ; CHDIR - SET CURRENT DIRECTORY
     29	0010  CD 21			 int 21h
     30	0012  72 20			 jc err_chdir
     31	0014  E8 0053			 call show_drive
     32	0017  E8 0065			 call show_cwd
     33
     34	001A  BA 000Ar			 mov dx, offset	dir	     ; DS:DX ->	ASCIZ pathname
     35	001D  B4 39			 mov ah, 39h		     ; MKDIR - CREATE SUBDIRECTORY
     36	001F  CD 21			 int 21h
     37	0021  72 2C			 jc err_mkdir
     38
     39	0023  BA 000Ar			 mov dx,offset dir	     ; DS:DX ->	ASCIZ pathname to become current directory
     40	0026  B4 3B			 mov ah,3Bh		     ; CHDIR - SET CURRENT DIRECTORY
     41	0028  CD 21			 int 21h
     42	002A  72 08			 jc err_chdir
     43	002C  E8 0050			 call show_cwd
     44
     45	002F  B8 4C00			 mov ax,4c00h
     46	0032  CD 21			 int 21h
     47
     48	0034			     err_chdir:
     49	0034  A3 0073r			 mov [temp], ax
     50	0037  BA 0059r			 mov dx, OFFSET	errchdir
     51	003A  B4 09			 mov ah, 09h
     52	003C  CD 21			 int 21h
     53	003E  A1 0073r			 mov ax, [temp]
     54	0041  8A D0			 mov dl, al
     55	0043  80 CA 30			 or dl,	30h
     56	0046  B4 02			 mov ah, 02
     57	0048  CD 21			 int 21h
Turbo Assembler	 Version 4.1	    12/07/19 01:50:39	    Page 2
myemu.ASM



     58	004A  B8 4C01			 mov ax,4c01h
     59	004D  CD 21			 int 21h
     60
     61
     62	004F			     err_mkdir:
     63	004F  A3 0073r			 mov [temp], ax
     64	0052  BA 0066r			 mov dx, OFFSET	errmkdir
     65	0055  B4 09			 mov ah, 09h
     66	0057  CD 21			 int 21h
     67
     68	0059  A1 0073r			 mov ax, [temp]
     69	005C  8A D0			 mov dl, al
     70	005E  80 CA 30			 or dl,	30h
     71	0061  B4 02			 mov ah, 02
     72	0063  CD 21			 int 21h
     73
     74	0065  B8 4C02			 mov ax,4c02h
     75	0068  CD 21			 int 21h
     76
     77	006A			     show_drive:
     78	006A  B4 19			 mov ah, 19h		     ; GET CURRENT DEFAULT DRIVE
     79	006C  CD 21			 int 21h
     80	006E  8A D0			 mov dl, al
     81	0070  80 C2 41			 add dl, 41h
     82	0073  B4 02			 mov ah, 02h
     83	0075  CD 21			 int 21h
     84	0077  B2 3A			 mov dl, ':'
     85	0079  CD 21			 int 21h
     86
     87	007B  E8 001E			 call crlf
     88	007E  C3			 ret
     89
     90	007F			     show_cwd:
     91	007F  BE 0019r			 mov si, OFFSET	buf
     92	0082  32 D2			 xor dl, dl		     ; Actual drive
     93	0084  B4 47			 mov ah, 47h		     ; CWD - GET CURRENT DIRECTORY
     94	0086  CD 21			 int 21h
     95
     96	0088  BE 0019r			 mov si, OFFSET	buf	     ; Print buf until '\0'
     97	008B				 L1:
     98	008B  AC			 lodsb
     99	008C  84 C0			 test al, al
    100	008E  74 08			 jz L2
    101	0090  8A D0			 mov dl, al
    102	0092  B4 02			 mov ah, 02h
    103	0094  CD 21			 int 21h
    104	0096  EB F3			 jmp L1
    105
    106	0098				 L2:
    107	0098  E8 0001			 call crlf
    108
    109	009B  C3			 ret
    110
    111	009C			     crlf:
    112	009C  B4 02			 mov ah, 02h
    113	009E  B2 0D			 mov dl, 13
    114	00A0  CD 21			 int 21h
Turbo Assembler	 Version 4.1	    12/07/19 01:50:39	    Page 3
myemu.ASM



    115	00A2  B2 0A			 mov dl, 10
    116	00A4  CD 21			 int 21h
    117	00A6  C3			 ret
    118				     end start
Turbo Assembler	 Version 4.1	    12/07/19 01:50:39	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "12/07/19"
??FILENAME			  Text	 "myemu	  "
??TIME				  Text	 "01:50:39"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 MYEMU
@INTERFACE			  Text	 000H
@MODEL				  Text	 2
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BUF				  Byte	 DGROUP:0019
CD				  Byte	 DGROUP:0000
CRLF				  Near	 _TEXT:009C
DIR				  Byte	 DGROUP:000A
ERRCHDIR			  Byte	 DGROUP:0059
ERRMKDIR			  Byte	 DGROUP:0066
ERR_CHDIR			  Near	 _TEXT:0034
ERR_MKDIR			  Near	 _TEXT:004F
L1				  Near	 _TEXT:008B
L2				  Near	 _TEXT:0098
SHOW_CWD			  Near	 _TEXT:007F
SHOW_DRIVE			  Near	 _TEXT:006A
START				  Near	 _TEXT:0000
TEMP				  Word	 DGROUP:0073

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  STACK				  16  0400 Para	  Stack	  STACK
  _DATA				  16  0075 Word	  Public  DATA
_TEXT				  16  00A7 Word	  Public  CODE
