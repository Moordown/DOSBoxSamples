*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        11/30/92            PRTSETUP.SPR               12:06:55 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1992 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("_qb70pytg1")
	DEFINE WINDOW _qb70pytg1 ;
		FROM INT((SROW()-15)/2),INT((SCOL()-57)/2) ;
		TO INT((SROW()-15)/2)+14,INT((SCOL()-57)/2)+56 ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		DOUBLE ;
		COLOR SCHEME 5
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                PRTSETUP/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
skipvar = .T.
pfilname = SPACE(67)

pdest = SET('PRINTER',1)
IF ":" $ pdest
   pdest = LEFT(pdest,AT(':',pdest)-1)
ENDIF
IF !INLIST(pdest,'PRN','LPT1','LPT2','LPT3','COM1','COM2','COM3')
   pfilname = PADR(pdest,67)
   pdest = 'File'
ENDIF
origdest = pdest
prt_infile =pfilname

IF SET('PRINT') = 'ON'
   prtstat = 1
ELSE
   prtstat = 2
ENDIF
origprtstat = prtstat

pdrivstup = IIF(LEN(_PDRIVER)=0,0,1)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     PRTSETUP/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("_qb70pytg1")
	ACTIVATE WINDOW _qb70pytg1 SAME
ELSE
	ACTIVATE WINDOW _qb70pytg1 NOSHOW
ENDIF
@ 1,2 TO 12,40
@ 3,9 SAY "Print to:" ;
	SIZE 1,9, 0
@ 0,2 SAY "Printer Setup:" ;
	SIZE 1,14, 0
@ 2,20 GET pdest ;
	PICTURE "@^ File;PRN;LPT1;LPT2;LPT3;COM1;COM2;COM3" ;
	SIZE 3,15 ;
	DEFAULT "LPT1" ;
	VALID _qb70pyu0s() ;
	COLOR SCHEME 5, 6
@ 5,4 GET flist ;
	PICTURE "@*HN \<File..." ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	VALID _qb70pyu4j()
@ 6,4 GET pfilname ;
	SIZE 1,35 ;
	DEFAULT " " ;
	PICTURE "@S67" ;
	VALID _qb70pyu9l()
@ 8,4 GET prtstat ;
	PICTURE "@*RVN Print On;Print Off" ;
	SIZE 1,13,0 ;
	DEFAULT 2
@ 8,36 GET _LMARGIN ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	VALID _qb70pyudj()
@ 9,36 GET _RMARGIN ;
	SIZE 1,3 ;
	DEFAULT " " ;
	PICTURE "999" ;
	VALID _qb70pyuga()
@ 5,43 GET OKbut ;
	PICTURE "@*HT \!\<OK" ;
	SIZE 1,10,6 ;
	DEFAULT 1
@ 7,43 GET CancBut ;
	PICTURE "@*HT \?\<Cancel" ;
	SIZE 1,10,1 ;
	DEFAULT 1
@ 11,4 GET pdrivstup ;
	PICTURE "@*C Printer \<Driver Setup..." ;
	SIZE 1,27 ;
	DEFAULT 0 ;
	VALID _qb70pyujw()
@ 8,22 SAY "Left Margin:" ;
	SIZE 1,12, 0
@ 9,22 SAY "Right Margin:" ;
	SIZE 1,13, 0

IF NOT WVISIBLE("_qb70pytg1")
	ACTIVATE WINDOW _qb70pytg1
ENDIF

READ CYCLE MODAL ;
	DEACTIVATE _qb70pyuof() ;
	SHOW _qb70pyuon()

RELEASE WINDOW _qb70pytg1

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     PRTSETUP/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
DO CASE
CASE okbut = 1
   SET PRINTER TO

   IF prtstat = 1
      SET PRINT ON
   ELSE
      SET PRINT OFF
   ENDIF

   pdest = ALLTRIM(UPPER(pdest))
   DO CASE
   CASE pdest = 'FILE'
      IF !EMPTY(pfilname)
         SET PRINTER TO (pfilname)
      ELSE
         SET PRINTER TO
      ENDIF
   OTHERWISE
      pfilname = ''
      SET PRINTER TO &pdest
   ENDCASE
CASE cancbut = 1
   IF origprtstat = 1
      SET PRINT ON
   ELSE
      SET PRINT OFF
   ENDIF
   pdest = origdest
   pfilname = prt_infile
ENDCASE
skipvar = .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYU0S           pdest VALID                        
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP,     Record Number:    5  
*        Variable:            pdest                              
*        Called By:           VALID Clause                       
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyu0s     &&  pdest VALID
#REGION 1
IF UPPER(pdest) = 'FILE'
   _CUROBJ = 3
ENDIF
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYU4J           flist VALID                        
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP,     Record Number:    6  
*        Variable:            flist                              
*        Called By:           VALID Clause                       
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyu4j     &&  flist VALID
#REGION 1
IF flist = 1
   origfile = pfilname
   pfilname = GETFILE('','Print to:')
   IF EMPTY(pfilname)
      pfilname = origfile
   ENDIF
ENDIF
pfilname = UPPER(PADR(pfilname,67))
IF !EMPTY(pfilname)
   pdest = 'File'
ENDIF
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYU9L           pfilname VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP,     Record Number:    7  
*        Variable:            pfilname                           
*        Called By:           VALID Clause                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyu9l     &&  pfilname VALID
#REGION 1
pfilname = PADR(UPPER(LTRIM(pfilname)),67)
IF !EMPTY(pfilname)
   pdest = 'File'
ENDIF
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYUDJ           _LMARGIN VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP,     Record Number:    9  
*        Variable:            _LMARGIN                           
*        Called By:           VALID Clause                       
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyudj     &&  _LMARGIN VALID
#REGION 1
_LMARGIN = MAX(0,_LMARGIN)
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYUGA           _RMARGIN VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP,     Record Number:   10  
*        Variable:            _RMARGIN                           
*        Called By:           VALID Clause                       
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyuga     &&  _RMARGIN VALID
#REGION 1
_RMARGIN = MIN(_RMARGIN,255)
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYUJW           pdrivstup VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP,     Record Number:   13  
*        Variable:            pdrivstup                          
*        Called By:           VALID Clause                       
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyujw     &&  pdrivstup VALID
#REGION 1
DO (_GENPD) WITH 1,"?"
IF LEN(_PDSETUP) = 0
   pdrivstup = 0
ELSE
   pdrivstup = 1
ENDIF
SHOW GET pdrivstup


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYUOF           Read Level Deactivate              
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP                           
*        Called By:           READ Statement                     
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyuof     && Read Level Deactivate
*
* Deactivate Code from screen: PRTSETUP
*
#REGION 1
?? CHR(7)
RETURN .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB70PYUON           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         PRTSETUP                           
*        Called By:           READ Statement                     
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb70pyuon     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: PRTSETUP
*
#REGION 1
IF UPPER(pdest) = 'FILE'
   SHOW GET pfilname ENABLE
   IF EMPTY(pfilname)
      SHOW GET okbut DISABLE
   ELSE
      SHOW GET okbut ENABLE
   ENDIF
ELSE
   SHOW GET pfilname DISABLE
   SHOW GET okbut ENABLE
ENDIF

IF EMPTY(_GENPD)
   SHOW GET pdrivstup DISABLE
ELSE
   SHOW GET pdrivstup ENABLE
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF