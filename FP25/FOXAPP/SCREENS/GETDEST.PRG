*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        11/23/92             GETDEST.SPR               15:33:23 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1992 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("_qb00xccji")
	DEFINE WINDOW _qb00xccji ;
		FROM INT((SROW()-11)/2),INT((SCOL()-40)/2) ;
		TO INT((SROW()-11)/2)+10,INT((SCOL()-40)/2)+39 ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		DOUBLE ;
		COLOR SCHEME 5
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 GETDEST/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
skipvar = .T.
repbut = 1   && default button choice
repdest = SPACE(40)
okbut = 0

* Disable the file options if 'file' isn't the default destination
IF repbut = 3
   SHOW GET repdest ENABLE
   SHOW GET rfile   ENABLE
ELSE
   SHOW GET repdest DISABLE
   SHOW GET rfile   DISABLE
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     GETDEST/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("_qb00xccji")
	ACTIVATE WINDOW _qb00xccji SAME
ELSE
	ACTIVATE WINDOW _qb00xccji NOSHOW
ENDIF
@ 0,9 SAY "Report destination:" ;
	SIZE 1,19, 0
@ 1,13 GET repbut ;
	PICTURE "@*RVN \<Screen;\<Printer;\<File" ;
	SIZE 1,11,0 ;
	DEFAULT 1 ;
	VALID _qb00xcdbb()
@ 4,2 GET rfile ;
	PICTURE "@*HN \<File" ;
	SIZE 1,6,1 ;
	DEFAULT 1 ;
	VALID _qb00xcdh2() ;
	DISABLE
@ 4,9 GET repdest ;
	SIZE 1,28 ;
	DEFAULT " " ;
	VALID _qb00xcdno() ;
	DISABLE
@ 6,13 GET okbut ;
	PICTURE "@*VT \!\<OK" ;
	SIZE 1,10,1 ;
	DEFAULT 1
@ 8,13 GET canclbut ;
	PICTURE "@*HT \?\<Cancel" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _qb00xcdv9()

IF NOT WVISIBLE("_qb00xccji")
	ACTIVATE WINDOW _qb00xccji
ENDIF

READ CYCLE MODAL ;
	DEACTIVATE _qb00xce0z() ;
	SHOW _qb00xce10()

RELEASE WINDOW _qb00xccji

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      GETDEST/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
skipvar = .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB00XCDBB           repbut VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         GETDEST,     Record Number:    3   
*        Variable:            repbut                             
*        Called By:           VALID Clause                       
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb00xcdbb     &&  repbut VALID
#REGION 1
IF repbut <> 3
   SHOW GET rfile DISABLE
   SHOW GET repdest DISABLE
ELSE
   SHOW GET rfile ENABLE
   SHOW GET repdest ENABLE
   _CUROBJ = 5
ENDIF
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB00XCDH2           rfile VALID                        
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         GETDEST,     Record Number:    4   
*        Variable:            rfile                              
*        Called By:           VALID Clause                       
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb00xcdh2     &&  rfile VALID
#REGION 1
olddest = repdest
repdest = PUTFILE('Output report to:','REPORT.TXT','TXT','OK')
IF EMPTY(repdest)
   repdest = olddest
   SHOW GET okbut DISABLE
ELSE
   SHOW GET okbut ENABLE
ENDIF
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB00XCDNO           repdest VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         GETDEST,     Record Number:    5   
*        Variable:            repdest                            
*        Called By:           VALID Clause                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb00xcdno     &&  repdest VALID
#REGION 1
m.repdest = PADR(ALLTRIM(UPPER(m.repdest)),40)

IF EMPTY(m.repdest)
   SHOW GET okbut DISABLE
ELSE
   SHOW GET okbut ENABLE
ENDIF
SHOW GETS


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB00XCDV9           canclbut VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         GETDEST,     Record Number:    7   
*        Variable:            canclbut                           
*        Called By:           VALID Clause                       
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb00xcdv9     &&  canclbut VALID
#REGION 1
repdest = ''

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB00XCE0Z           Read Level Deactivate              
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         GETDEST                            
*        Called By:           READ Statement                     
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb00xce0z     && Read Level Deactivate
*
* Deactivate Code from screen: GETDEST
*
#REGION 1
?? CHR(7)
RETURN .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _QB00XCE10           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         GETDEST                            
*        Called By:           READ Statement                     
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _qb00xce10     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: GETDEST
*
#REGION 1
IF repbut = 3
   SHOW GET repdest ENABLE
   SHOW GET rfile   ENABLE
ELSE
   SHOW GET repdest DISABLE
   SHOW GET rfile   DISABLE
ENDIF

IF repbut = 3 AND EMPTY(repdest)
   SHOW GET okbut DISABLE
ELSE
   SHOW GET okbut ENABLE
ENDIF

IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF